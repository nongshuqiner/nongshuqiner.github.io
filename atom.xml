<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://nongshuqiner.github.io/</id>
    <title>Gridea</title>
    <updated>2021-11-26T09:19:58.787Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://nongshuqiner.github.io/"/>
    <link rel="self" href="https://nongshuqiner.github.io/atom.xml"/>
    <subtitle>悟时超十地三乘，凝滞了四生六道...</subtitle>
    <logo>https://nongshuqiner.github.io/images/avatar.png</logo>
    <icon>https://nongshuqiner.github.io/favicon.ico</icon>
    <rights>All rights reserved 2021, Gridea</rights>
    <entry>
        <title type="html"><![CDATA[生成树结构（一维数组转树形结构、生成树菜单）]]></title>
        <id>https://nongshuqiner.github.io/post/sheng-cheng-shu-jie-gou-yi-wei-shu-zu-zhuan-shu-xing-jie-gou-sheng-cheng-shu-cai-dan/</id>
        <link href="https://nongshuqiner.github.io/post/sheng-cheng-shu-jie-gou-yi-wei-shu-zu-zhuan-shu-xing-jie-gou-sheng-cheng-shu-cai-dan/">
        </link>
        <updated>2021-11-26T07:56:27.000Z</updated>
        <content type="html"><![CDATA[<p>generate-tree.js</p>
<pre><code>/**
 * 生成树结构
 * Callback:
 * - node, 子节点
 * - props, 参数props
 * @param {Array} data 需要处理的数组
 * @param {Array} props 属性
 * @param {Function} strucChangeCallback 更改结构的回调函数
 */
export const generateTree = function (
  data,
  props = {
    parentId: &quot;parentId&quot;,
    id: &quot;id&quot;
  },
  strucChangeCallback = function (node, props) {
    return node;
  }
) {
  // 把跟节点首先放进数组，根节点支持：null 0 &quot;&quot;
  const tmpTree = data
    .filter(node =&gt; !node[props.parentId])
    .map(node =&gt; strucChangeCallback(node, props));
  // 递归生成节点及子节点数据
  const findChildren = tree =&gt; {
    tree.forEach(node =&gt; {
      node.children = data
        .filter(cNode =&gt; cNode[props.parentId] === node[props.id])
        .map(node =&gt; strucChangeCallback(node, props));
      if (node.children.length) {
        findChildren(node.children);
      }
    });
  };

  findChildren(tmpTree);

  return tmpTree;
}
</code></pre>
<p>使用案例:</p>
<pre><code>// example:
const data = [{
    &quot;createTime&quot;: &quot;2021-10-27 11:32:00&quot;,
    &quot;id&quot;: 1,
    &quot;isLeaf&quot;: 0,
    &quot;name&quot;: &quot;根目录&quot;,
    &quot;parent&quot;: 0,
    &quot;type&quot;: &quot;ROOT&quot;,
    &quot;updateTime&quot;: &quot;2021-10-27 11:32:00&quot;
  },
  {
    &quot;createTime&quot;: &quot;2021-10-29 15:02:03&quot;,
    &quot;id&quot;: 2,
    &quot;isLeaf&quot;: 0,
    &quot;name&quot;: &quot;子目录1&quot;,
    &quot;parent&quot;: 1,
    &quot;type&quot;: &quot;OBJ&quot;,
    &quot;updateTime&quot;: &quot;2021-11-05 15:18:12&quot;
  },
  {
    &quot;createTime&quot;: &quot;2021-10-29 15:02:03&quot;,
    &quot;id&quot;: 3,
    &quot;isLeaf&quot;: 0,
    &quot;name&quot;: &quot;子目录2&quot;,
    &quot;parent&quot;: 1,
    &quot;type&quot;: &quot;MODEL&quot;,
    &quot;updateTime&quot;: &quot;2021-11-05 15:18:13&quot;
  },
  {
    &quot;createTime&quot;: &quot;2021-10-29 15:02:03&quot;,
    &quot;id&quot;: 4,
    &quot;isLeaf&quot;: 0,
    &quot;name&quot;: &quot;子目录3&quot;,
    &quot;parent&quot;: 1,
    &quot;type&quot;: &quot;FUNC&quot;,
    &quot;updateTime&quot;: &quot;2021-11-05 15:18:14&quot;
  },
  {
    &quot;createTime&quot;: &quot;2021-10-29 15:02:03&quot;,
    &quot;id&quot;: 5,
    &quot;isLeaf&quot;: 0,
    &quot;name&quot;: &quot;子目录3&quot;,
    &quot;parent&quot;: 1,
    &quot;type&quot;: &quot;RESOURCE&quot;,
    &quot;updateTime&quot;: &quot;2021-11-05 15:18:16&quot;
  },
  {
    &quot;createTime&quot;: &quot;2021-10-29 15:02:03&quot;,
    &quot;id&quot;: 6,
    &quot;isLeaf&quot;: 0,
    &quot;name&quot;: &quot;子目录1-1&quot;,
    &quot;parent&quot;: 2,
    &quot;type&quot;: &quot;OBJ&quot;,
    &quot;updateTime&quot;: &quot;2021-11-05 15:18:12&quot;
  },
  {
    &quot;createTime&quot;: &quot;2021-10-29 15:02:03&quot;,
    &quot;id&quot;: 7,
    &quot;isLeaf&quot;: 0,
    &quot;name&quot;: &quot;子目录1-2&quot;,
    &quot;parent&quot;: 2,
    &quot;type&quot;: &quot;OBJ&quot;,
    &quot;updateTime&quot;: &quot;2021-11-05 15:18:12&quot;
  },
  {
    &quot;createTime&quot;: &quot;2021-10-29 15:02:03&quot;,
    &quot;id&quot;: 8,
    &quot;isLeaf&quot;: 0,
    &quot;name&quot;: &quot;子目录1-3&quot;,
    &quot;parent&quot;: 2,
    &quot;type&quot;: &quot;OBJ&quot;,
    &quot;updateTime&quot;: &quot;2021-11-05 15:18:12&quot;
  },
  {
    &quot;createTime&quot;: &quot;2021-10-29 15:02:03&quot;,
    &quot;id&quot;: 9,
    &quot;isLeaf&quot;: 1,
    &quot;name&quot;: &quot;叶子1-1-1&quot;,
    &quot;parent&quot;: 6,
    &quot;type&quot;: &quot;OBJ&quot;,
    &quot;updateTime&quot;: &quot;2021-11-05 15:18:12&quot;
  },
  {
    &quot;createTime&quot;: &quot;2021-10-29 15:02:03&quot;,
    &quot;id&quot;: 10,
    &quot;isLeaf&quot;: 1,
    &quot;name&quot;: &quot;叶子1-1-2&quot;,
    &quot;parent&quot;: 6,
    &quot;type&quot;: &quot;OBJ&quot;,
    &quot;updateTime&quot;: &quot;2021-11-05 15:18:12&quot;
  },
  {
    &quot;createTime&quot;: &quot;2021-10-29 15:02:03&quot;,
    &quot;id&quot;: 11,
    &quot;isLeaf&quot;: 1,
    &quot;name&quot;: &quot;叶子1-1-3&quot;,
    &quot;parent&quot;: 6,
    &quot;type&quot;: &quot;OBJ&quot;,
    &quot;updateTime&quot;: &quot;2021-11-05 15:18:12&quot;
  }
];
let tree = generateTree(
  data,
  { parentId: &quot;parent&quot;, id: &quot;id&quot; },
  (node, props) =&gt; {
    return {
      id: node[props.id],
      parentId: node[props.parentId],
      name: node.name,
      type: node.type,
      isLeaf: node.isLeaf,
      children: null,
      disabled: node.disabled ? node.disabled : false,
      ele: node
    };
  }
);
console.log(tree);
</code></pre>
<p>结果：</p>
<figure data-type="image" tabindex="1"><img src="https://upload-images.jianshu.io/upload_images/4645892-df02c3761df89cbb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="generateTree运行结果" loading="lazy"></figure>
<h2 id="结语">结语</h2>
<p>提示：后面还有精彩敬请期待，请大家关注我的专题：<a href="http://www.jianshu.com/c/3cd9ede78e18">web前端</a>。如有意见可以进行评论，每一条评论我都会认真对待。</p>
]]></content>
    </entry>
</feed>